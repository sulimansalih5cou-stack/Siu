<!DOCTYPE html>

<html lang="ar" dir="rtl">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>كشف الحساب - Smart Dorm</title>

    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

    <style>

        /* ... (الـ Styles تبقى كما هي من الردود السابقة) ... */

        body {

            background-color: #F3F4F6;

            font-family: 'Cairo', sans-serif;

            padding-bottom: 60px;

        }



        .user-profile-card {

            background: linear-gradient(135deg, #B91C1C 0%, #991B1B 100%);

            color: white; padding: 25px 20px;

            border-bottom-left-radius: 25px; border-bottom-right-radius: 25px;

            margin-bottom: 20px;

            box-shadow: 0 10px 25px -5px rgba(185, 28, 28, 0.4);

        }



        .back-btn {

            background: rgba(255,255,255,0.2); padding: 6px 14px;

            border-radius: 8px; color: white; text-decoration: none;

            font-size: 0.9rem; transition: background 0.3s;

        }

        .back-btn:hover { background: rgba(255,255,255,0.3); }



        .bankak-card {

            background: white; border: 1px solid #F3F4F6;

            border-radius: 12px; margin-bottom: 15px;

            padding: 15px 18px; position: relative;

            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);

            display: flex; flex-direction: column; transition: transform 0.2s ease;

        }

        .bankak-card:hover { transform: translateY(-2px); }

        .card-main-content {

            display: flex; justify-content: space-between; 

            align-items: center; margin-bottom: 10px;

            padding-bottom: 10px; border-bottom: 1px dashed #E5E7EB;

        }



        .amount-display {

            font-size: 1.4rem; font-weight: 800; direction: ltr; 

            font-family: sans-serif; order: 2; margin-right: auto;

        }

        .amount-pos { color: #059669; }

        .amount-neg { color: #DC2626; }

        .details-wrapper {

            display: flex; align-items: center; order: 1; flex-grow: 1;

        }

        .details-text { margin-right: 10px; }

        .transaction-title { font-weight: 700; color: #1F2937; font-size: 1rem; }

        .transaction-sub { font-size: 0.85rem; color: #6B7280; }

        .bank-icon-container {

            width: 45px; height: 45px; border-radius: 50%;

            display: flex; align-items: center; justify-content: center;

            border: 2px solid; position: relative; background-color: #FAFAFA;

            flex-shrink: 0;

        }

        .icon-success { border-color: #059669; color: #059669; }

        .icon-danger { border-color: #DC2626; color: #DC2626; }

        .arrow-badge {

            position: absolute; bottom: -2px; right: -2px;

            background: white; border-radius: 50%;

            padding: 2px; font-size: 0.7rem;

            box-shadow: 0 1px 3px rgba(0,0,0,0.1);

        }

        .card-footer-date {

            text-align: right; font-size: 0.75rem; color: #9CA3AF;

            font-weight: 600; display: flex; justify-content: space-between;

            align-items: center;

        }



        .filter-scroll {

            display: flex; gap: 10px; overflow-x: auto;

            padding-bottom: 10px; margin-bottom: 10px;

            scrollbar-width: none;

        }

        .filter-scroll::-webkit-scrollbar { display: none; }

        .filter-pill {

            white-space: nowrap; padding: 6px 16px;

            border-radius: 20px; background: white;

            color: #6B7280; font-size: 0.85rem; font-weight: 600;

            border: 1px solid #E5E7EB; cursor: pointer; transition: 0.2s;

        }

        .filter-pill.active {

            background: #FEF2F2; color: #B91C1C; border-color: #B91C1C;

        }

        

        .modal {

            display: none; position: fixed; inset: 0;

            background: rgba(0,0,0,0.6); backdrop-filter: blur(2px);

            align-items: center; justify-content: center; z-index: 1000;

        }

        .modal.show { display: flex; }

        .modal-content {

            background: white; padding: 30px; border-radius: 20px;

            width: 90%; max-width: 450px; text-align: center;

            box-shadow: 0 20px 50px rgba(0,0,0,0.2);

        }

        .form-label { display: block; font-weight: 700; color: #374151; margin-bottom: 8px; font-size: 0.95rem; text-align: right;}

        .form-input {

            width: 100%; padding: 10px; border: 1px solid #E5E7EB;

            border-radius: 8px; background: #F9FAFB; font-size: 1rem;

            font-family: 'Cairo', sans-serif;

        }

    </style>

</head>

<body>



    <div class="user-profile-card">

        <div class="flex justify-between items-center">

            <div>

                <h2 class="text-xl font-bold mb-1">مرحباً، <span id="displayHeaderName">...</span></h2>

                <p class="text-sm opacity-80 dir-ltr" id="displayHeaderEmail">...</p>

            </div>

            <a href="index.html" class="back-btn">

                <i class="fas fa-arrow-right ml-1"></i> رجوع

            </a>

        </div>

    </div>



    <div class="max-w-3xl mx-auto px-4">



        <div class="filter-scroll" id="filtersContainer">

            <div class="filter-pill active" onclick="setFilter('30days', this)">آخر 30 يوم</div>

            <div class="filter-pill" onclick="setFilter('summary', this)">ملخص الأرصدة</div> 

            <div class="filter-pill" onclick="setFilter('3months', this)">آخر 3 شهور</div>

            <div class="filter-pill" onclick="setFilter('incoming', this)">الواردة (لك)</div>

            <div class="filter-pill" onclick="setFilter('outgoing', this)">الصادرة (عليك)</div>

            <div class="filter-pill" onclick="setFilter('all', this)">الكل</div>

        </div>



        <div id="summaryContainer" class="mt-8 hidden">

            </div>



        <div id="expensesContainer" class="block">

            <p class="text-center text-gray-400 mt-12">

                <i class="fas fa-spinner fa-spin fa-2x mb-4"></i><br>

                جاري التحميل...

            </p>

        </div>

    </div>

    

    <div id="settleModal" class="modal">

        <div class="modal-content max-w-md">

            <h3 class="text-2xl font-bold mb-4 text-gray-800 text-center">تسجيل التسوية النقدية</h3>

            

            <div id="settleSummary" class="text-right text-gray-600 mb-6 text-base space-y-2 p-4 border rounded-lg bg-gray-50">

                </div>



            <div class="text-right mb-5 border-t pt-4">

                <p class="font-bold text-gray-700 mb-3"><i class="fas fa-money-check-alt ml-1 text-blue-500"></i> بيانات التحويل البنكي</p>

                

                <div class="mb-4">

                    <label class="form-label" for="settleReference">رقم العملية (المرجع) - 4 أرقام</label>

                    <input type="text" id="settleReference" class="form-input text-left font-bold" placeholder="أدخل مرجع العملية من الإشعار" style="direction: ltr;" required maxlength="4">

                </div>

                

                <div class="mb-6">

                    <label class="form-label" for="settleAmountInput">المبلغ الذي تم تحويله (SDG)</label>

                    <input type="tel" id="settleAmountInput" class="form-input text-left font-bold" placeholder="أدخل المبلغ الذي ظهر في الإشعار" oninput="formatNumber(this)" style="direction: ltr;" required>

                    <p class="text-sm text-red-500 mt-1 text-right" id="amountWarning"></p>

                </div>

            </div>



            <div class="flex gap-3 justify-center">

                <button onclick="confirmSettleUp()" id="confirmSettleButton" class="bg-blue-600 text-white py-3 px-8 rounded-xl font-bold hover:bg-blue-700">تأكيد التسوية</button>

                <button onclick="hideSettleModal()" class="bg-gray-200 text-gray-700 py-3 px-8 rounded-xl font-bold hover:bg-gray-300">إلغاء</button>

            </div>

        </div>

    </div>

    

    <div id="successModal" class="modal">

        <div class="modal-content">

            <div class="text-green-500 text-5xl mb-3"><i class="fas fa-check-circle"></i></div>

            <h3 class="text-xl font-bold text-gray-800 mb-2">تمت التسوية بنجاح!</h3>

            <p class="text-gray-500 text-sm mb-5">تم تحديث الأرصدة وتسجيل العملية.</p>

            <button onclick="hideSuccessModal()" class="bg-blue-600 text-white w-full py-3 rounded-xl font-bold">حسناً</button>

        </div>

    </div>

    

    <script src="script.js" type="module"></script> 

</body>

</html>